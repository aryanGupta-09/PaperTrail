<h1>Data from Sources:</h1>

<!-- SerpAPI Results Table -->
<h2>SerpAPI Results</h2>
<% if (serpapi_results && serpapi_results.organic_results && serpapi_results.organic_results.length) { %>
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Snippet</th>
                <th>Authors</th>
                <th>Year</th>
                <th>Link</th>
            </tr>
        </thead>
        <tbody>
            <% serpapi_results.organic_results.forEach(result => { %>
                <tr>
                    <td><%= result.title %></td>
                    <td><%= result.snippet %></td>

                    <td>
                        <% if (result.publication_info && result.publication_info.authors) { %>
                            <%= result.publication_info.authors.map(author => author.name).join(', ') %>
                        <% } else { %>
                            Unknown
                        <% } %>
                    </td>

                    <td>
                        <% if (result.publication_info && result.publication_info.summary) { %>
                            <% const yearMatch = result.publication_info.summary.match(/\b(19|20)\d{2}\b/); %>
                            <%= yearMatch ? yearMatch[0] : 'Unknown' %>
                        <% } else { %>
                            Unknown
                        <% } %>
                    </td>
                    
                    <td><a href="<%= result.link %>" target="_blank">View</a></td>
                </tr>
            <% }) %>
        </tbody>
    </table>
<% } else { %>
    <p>No results found for SerpAPI.</p>
<% } %>

<!-- DBLP Results Table -->
<h2>DBLP Results</h2>
<% if (dblp_results && dblp_results.length) { %>
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Authors</th>
                <th>Year</th>
                <th>Link</th>
            </tr>
        </thead>
        <tbody>
            <% dblp_results.forEach(result => { %>
                <tr>
                    <td><%= result.info.title %></td>
                    <td>
                        <%= Array.isArray(result.info.authors?.author)
                            ? result.info.authors.author.map(a => a.text).join(', ')
                            : result.info.authors?.author?.text || 'Unknown authors' %>
                    </td>
                    <td><%= result.info.year || 'N/A' %></td>
                    <td><a href="<%= result.info.url %>" target="_blank">View</a></td>
                </tr>
            <% }) %>
        </tbody>
    </table>
<% } else { %>
    <p>No results found for DBLP.</p>
<% } %>

<!-- arXiv Results Table -->
<h2>arXiv Results</h2>
<% if (arXiv_results && arXiv_results.length) { %>
    <table>
        <thead>
            <tr>
                <th>Title</th>
                <th>Summary</th>
                <th>Authors</th>
                <th>Published Date</th>
                <th>Link</th>
            </tr>
        </thead>
        <tbody>
            <% arXiv_results.forEach(result => { %>
                <tr>
                    <td><%= result.title[0] %></td>
                    <td><%= result.summary[0].substring(0, 100) %>...</td> <!-- Limit summary for readability -->
                    <td><%= result.author ? result.author.map(a => a.name[0]).join(', ') : 'Unknown authors' %></td>
                    <td><%= result.published[0] %></td>
                    <td><a href="<%= result.id[0] %>" target="_blank">View</a></td>
                </tr>
            <% }) %>
        </tbody>
    </table>
<% } else { %>
    <p>No results found for arXiv.</p>
<% } %>
